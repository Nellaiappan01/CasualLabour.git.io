<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ESCEE - Casual Labour Form</title>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;900&display=swap');

    * { box-sizing: border-box; }
    body {
      font-family: "Poppins", sans-serif;
      margin: 0;
      padding: 0;
      width: 100vw;
      height: 100vh;
      background: #ecf0f3;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      text-align: center;
    }

    .container {
      position: relative;
      width: 350px;
      height: auto;
      border-radius: 20px;
      padding: 32px;
      background: #ecf0f3;
      box-shadow: 14px 14px 20px #cbced1, -14px -14px 20px white;
    }

    .content h2 {
      margin: 0;
      color: transparent;
      -webkit-text-stroke: 2px #dbdddd;
      font-size: 2.2rem;
      letter-spacing: 6px;
    }

    .content h2.overlay {
      position: relative;
      margin-top: -2.4rem;
      color: #9bd9f5;
      -webkit-text-stroke: 0;
      animation: animate 4s ease-in-out infinite;
      letter-spacing: 6px;
      font-size: 2.2rem;
    }

    @keyframes animate {
      0%,100% {
        clip-path: polygon(
          0% 45%,16% 44%,33% 50%,54% 60%,70% 61%,84% 59%,100% 52%,100% 100%,0% 100%
        );
      }
      50% {
        clip-path: polygon(
          0% 60%,15% 65%,34% 66%,51% 62%,67% 50%,84% 45%,100% 46%,100% 100%,0% 100%
        );
      }
    }

    .brand-title {
      margin-top: 12px;
      color: #6968c7;
      font-weight: 900;
      font-size: 0.9rem;
      letter-spacing: 1px;
      text-decoration-line: underline;
      text-decoration-style: double;
      text-decoration-thickness: 1px;
      text-underline-position: under;
    }

    .inputs {
      text-align: left;
      margin-top: 18px;
    }

    label, input, select, button {
      display: block;
      width: 100%;
      padding: 0;
      border: none;
      outline: none;
      box-sizing: border-box;
      background: none;
      font-family: inherit;
    }

    input::placeholder { color: gray; }

    input[type="date"],
    input[type="number"],
    select {
      margin-top: 12px;
      margin-bottom: 4px;
      background: #ecf0f3;
      padding: 10px 18px;
      height: 48px;
      font-size: 14px;
      border-radius: 50px;
      box-shadow: inset 6px 6px 6px #cbced1, inset -6px -6px 6px white;
      width: calc(100% - 0px);
    }

    button {
      color: white;
      margin-top: 18px;
      background: #1DA1F2;
      height: 44px;
      border-radius: 22px;
      cursor: pointer;
      font-weight: 900;
      box-shadow: 6px 6px 6px #cbced1, -6px -6px 6px white;
      transition: 0.25s;
    }
    button:hover {
      box-shadow: none;
      background-color:#0b81f0;
    }

    .result {
      color: green;
      font-size: 16px;
      min-height: 22px;
      margin-bottom: 6px;
    }

    a.view-sheet {
      display: inline-block;
      margin-top: 10px;
      font-size: 12px;
      color: black;
      background: rgba(177,176,175,0.12);
      padding: 6px 8px;
      border-radius: 8px;
      text-decoration: none;
    }

    @media (max-width: 420px) {
      .container { width: calc(100% - 24px); padding: 20px; }
    }
  </style>
</head>
<body>
  <main class="container" role="main">
    <div class="content">
      <h2>ESCEE</h2>
      <h2 class="overlay">ESCEE</h2>
    </div>

    <div class="brand-title">INDUSTRIES PRIVATE LIMITED</div>

    <form id="form" method="post" class="formm" novalidate>
      <div id="res" class="result"></div>

      <div class="inputs">
        <!-- Date input (visible) -->
        <label for="workDate" style="font-size:12px;color:#666;margin-bottom:6px;">Date</label>
        <input id="workDate" name="Date" type="date" required />

        <!-- Contractor (main) -->
        <label for="contractorSelect" style="font-size:12px;color:#666;margin-top:6px;">Contractor</label>
        <select id="contractorSelect" class="myDropdown" name="ContractorVisible">
          <option value="">-- Select contractor --</option>
          <option value="M.Ambikavathy">M.Ambikavathy</option>
          <option value="M.Muniyasamy">M.Muniyasamy</option>
          <option value="A.Gurusamy">A.Gurusamy</option>
          <option value="P.Ezhilarasan">P.Ezhilarasan</option>
          <option value="A.Ramasamy">A.Ramasamy</option>
          <option value="M.Rangasamy">M.Rangasamy</option>
          <option value="I.BackiyaRaj">I.BackiyaRaj</option>
          <option value="Abbas">Abbas</option>
          <option value="AnthonySamy">AnthonySamy</option>
          <option value="NagaRaj">NagaRaj</option>
          <option value="Thon Xavier">Thon Xavier</option>
          <option value="S.Pandi">S.Pandi</option>
          <option value="S.Murgandi">S.Murgandi</option>
          <option value="Devaraj">Devaraj</option>
          <option value="P.Rajiv Gandhi">P.Rajiv Gandhi</option>
          <option value="Thommai Arulanatham">Thommai Arulanatham</option>
          <option value="AnthonySamy(P block)">AnthonySamy(P block)</option>
          <option value="Anthony Arockiya Selvan">Anthony Arockiya Selvan</option>
          <option value="A.Selvaraj">A.Selvaraj</option>
          <option value="Saveri Muthu">Saveri Muthu</option>
          <option value="AnthonyRayyappan">AnthonyRayyappan</option>
          <option value="Thangaraj">Thangaraj</option>
          <option value="SennaMuniyasamy">SennaMuniyasamy</option>
          <option value="Ganeshan">Ganeshan</option>
          <option value="Muthulakshmi">Muthulakshmi</option>
          <option value="Shanmugalakshmi">Shanmugalakshmi</option>
        </select>

        <!-- Alternate contractors -->
        <label for="contractorAlt" style="font-size:12px;color:#666;margin-top:6px;">Alternate Contractor</label>
        <select id="contractorAlt" class="myDropdown01">
          <option value="">-- Select (optional) --</option>
          <option value="C.Ganesh Ayyadurai">C.Ganesh Ayyadurai</option>
          <option value="A.Peppy">A.Peppy</option>
        </select>

        <!-- Area -->
        <label for="areaSelect" style="font-size:12px;color:#666;margin-top:6px;">Area</label>
        <select id="areaSelect" class="myDropdown2">
          <option value="">-- Select area --</option>
          <option value="A,B,K,O & H,I,J,L Block">A,B,K,O & H,I,J,L Block</option>
          <option value="Q & S Block">Q & S Block</option>
          <option value="D,E,F,G & C,M,N,R Block">D,E,F,G & C,M,N,R Block</option>
          <option value="Seashore & Stor.Yard">Seashore & Stor.Yard</option>
          <option value="180 KVA">180 KVA</option>
          <option value="P Block">P Block</option>
        </select>

        <!-- Work description -->
        <label for="workDesc" style="font-size:12px;color:#666;margin-top:6px;">Work Description</label>
        <select id="workDesc" class="myDropdown3">
          <option value="">-- Select work --</option>
          <option value="Brine Pumping Work">Brine Pumping Work</option>
          <option value="Day & Night Watchman Work">Day & Night Watchman Work</option>
          <option value="Company Work">Company Work</option>
        </select>

        <!-- Shift -->
        <label for="shiftSelect" style="font-size:12px;color:#666;margin-top:6px;">Shift</label>
        <select id="shiftSelect" class="myDropdown4">
          <option value="">-- Select shift --</option>
          <option value="Day">Day</option>
          <option value="Night">Night</option>
        </select>

        <!-- OT Hours -->
        <input id="otHours" name="OTHrs" type="number" placeholder="OT Hours" min="0" step="0.25" style="margin-top:12px;" />

        <!-- Hidden inputs used to carry readable text values to Google Sheet -->
        <input id="hiddenContractor" type="hidden" name="Name" />
        <input id="hiddenAltContractor" type="hidden" name="Contractor" />
        <input id="hiddenArea" type="hidden" name="Area" />
        <input id="hiddenWorkDesc" type="hidden" name="WorkDescription" />
        <input id="hiddenShift" type="hidden" name="WorkingShift" />

        <button name="btn" value="Add" type="submit">Submit</button>
      </div>

      <a class="view-sheet" href="https://docs.google.com/spreadsheets/d/1bmP8f-rv28eqfe1wwKVNZoFenyB0ZDrK9pEUS5AdJIw/edit?usp=sharing" target="_blank" rel="noopener">View GoogleSheet</a>
    </form>
  </main>

  <script>
    // Safely get elements
    const contractorSelect = document.getElementById('contractorSelect');
    const contractorAlt = document.getElementById('contractorAlt');
    const areaSelect = document.getElementById('areaSelect');
    const workDesc = document.getElementById('workDesc');
    const shiftSelect = document.getElementById('shiftSelect');

    const hiddenContractor = document.getElementById('hiddenContractor');
    const hiddenAltContractor = document.getElementById('hiddenAltContractor');
    const hiddenArea = document.getElementById('hiddenArea');
    const hiddenWorkDesc = document.getElementById('hiddenWorkDesc');
    const hiddenShift = document.getElementById('hiddenShift');

    // Keep visible selects in sync with hidden inputs (so readable labels are posted)
    if (contractorSelect) {
      contractorSelect.addEventListener('change', () => {
        hiddenContractor.value = contractorSelect.options[contractorSelect.selectedIndex].text;
      });
    }
    if (contractorAlt) {
      contractorAlt.addEventListener('change', () => {
        hiddenAltContractor.value = contractorAlt.options[contractorAlt.selectedIndex].text;
      });
    }
    if (areaSelect) {
      areaSelect.addEventListener('change', () => {
        hiddenArea.value = areaSelect.options[areaSelect.selectedIndex].text;
      });
    }
    if (workDesc) {
      workDesc.addEventListener('change', () => {
        hiddenWorkDesc.value = workDesc.options[workDesc.selectedIndex].text;
      });
    }
    if (shiftSelect) {
      shiftSelect.addEventListener('change', () => {
        hiddenShift.value = shiftSelect.options[shiftSelect.selectedIndex].text;
      });
    }

    // Set today's date on date input in YYYY-MM-DD
    (function setTodayDate() {
      const d = new Date();
      const yyyy = d.getFullYear();
      const mm = String(d.getMonth() + 1).padStart(2, '0');
      const dd = String(d.getDate()).padStart(2, '0');
      const iso = `${yyyy}-${mm}-${dd}`;
      const dateInput = document.getElementById('workDate');
      if (dateInput) dateInput.value = iso;
    })();

    // Form submit logic (Google Apps Script URL)
    const url = 'https://script.google.com/macros/s/AKfycbxjh1bVdZwM0Flpu43sVZL51C1DxLywlpx8TAoZt2WNy91ZWqkoJ9eIjJZgv8z84VB3/exec';
    const form = document.getElementById('form');
    const resultDiv = document.getElementById('res');

    if (form) {
      form.addEventListener('submit', (e) => {
        e.preventDefault();

        // Simple validation: ensure a contractor and date are present
        if (!contractorSelect || contractorSelect.value === '') {
          resultDiv.textContent = 'Please select a contractor.';
          setTimeout(() => resultDiv.textContent = '', 3000);
          return;
        }

        const submitButton = e.target.btn;
        if (submitButton) submitButton.innerHTML = 'Submitting...';

        const formData = new FormData(form);

        fetch(url, {
          method: 'POST',
          body: formData
        })
        .then(res => res.text())
        .then(finalRes => {
          if (submitButton) submitButton.innerHTML = 'Submit';
          resultDiv.innerHTML = finalRes || 'Submitted successfully';
          form.reset();

          // Clear hidden fields after reset
          hiddenContractor.value = '';
          hiddenAltContractor.value = '';
          hiddenArea.value = '';
          hiddenWorkDesc.value = '';
          hiddenShift.value = '';

          // reset date to today after reset
          (function setTodayAgain() {
            const d = new Date();
            const yyyy = d.getFullYear();
            const mm = String(d.getMonth() + 1).padStart(2, '0');
            const dd = String(d.getDate()).padStart(2, '0');
            const iso = `${yyyy}-${mm}-${dd}`;
            const dateInput = document.getElementById('workDate');
            if (dateInput) dateInput.value = iso;
          })();

          setTimeout(() => { resultDiv.textContent = ''; }, 3000);
        })
        .catch(err => {
          console.error(err);
          if (submitButton) submitButton.innerHTML = 'Submit';
          resultDiv.textContent = 'Submission failed. Check console for details.';
          setTimeout(() => { resultDiv.textContent = ''; }, 3000);
        });
      });
    }
  </script>
</body>
</html>
